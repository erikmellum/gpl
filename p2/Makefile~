# ***** this makefile will only work properly with gnu make *****

# it is a very good idea to install makedepend and run "make make"
# NOTE: makedepend often issues lots of warnings with ANSI C++ files
#       but it will put all the dependencies you need at the bottom of this file

# This Makefile links with the X-windows, OpenGL libraries, and Glut library
# These libraries are not needed until p6.  They are included here to
# encourage you to make sure they are properly installed on your system
# early in the semester.

# It is possible to create a much smaller Makefile that uses default
# rules to complie this program.  The point of not using default rules
# is to teach you more about how make works.  Once you understand what you
# are doing it is safe to use default rules.

CXX = g++

CPPFLAGS = -Wall -pedantic -g

# uncomment the lines for the machine you are compiling on

# linux/UNIX libraries (comment out next two lines if not using linux/unix)
LIBDIRS  = -L/usr/X11R6/lib
LIBS = -lX11 -lglut -lGL -lGLU -lm -lfl

# OS X (comment out next two lines if not using OSX)
# LIBS = -framework GLUT -framework OpenGL -lobjc
# OSX = -D OSX

# C++SRC = parser.cpp error.cpp gpl_assert.cpp

# C++OBJ = parser.o error.o gpl_assert.o

parser: y.tab.o lex.yy.o $(C++OBJ)
	g++ -g -o parser y.tab.o lex.yy.o $(C++OBJ) $(LIBDIRS) $(LIBS)

y.tab.c y.tab.h: array.y
	bison -vyd array.y

y.tab.o: y.tab.c 
	$(CXX) $(CPPFLAGS) -c y.tab.c

lex.yy.c: array.l
	flex array.l

lex.yy.o: lex.yy.c y.tab.h 
	$(CXX) $(CPPFLAGS) -c lex.yy.c

make:
	makedepend $(C++SRC) y.tab.c lex.yy.c array.l array.y
	@echo "************************************************************"
	@echo "************************************************************"
	@echo "************************************************************"
	@echo "It is \"normal\" for makedepend to generate lots of errors"
	@echo "If the errors have to do with ANSI C++ include files, ignore them"
	@echo "************************************************************"

clean:
	rm -f $(C++OBJ) parser lex.yy.c lex.yy.o \
	y.output y.tab.h y.tab.c y.tab.o \
	*.stackdump Makefile.bak

# Makedepend will fill in the correct dependencies at the end of this 
# file when you make "make":   $ make make
# The following lines were (or will be) generated by makedepend
# DO NOT DELETE

y.tab.o: error.h gpl_assert.h parser.h y.tab.h
lex.yy.o: /usr/include/stdio.h /usr/include/features.h
lex.yy.o: /usr/include/stdc-predef.h /usr/include/libio.h
lex.yy.o: /usr/include/_G_config.h /usr/include/wchar.h /usr/include/string.h
lex.yy.o: /usr/include/xlocale.h /usr/include/errno.h /usr/include/stdlib.h
lex.yy.o: /usr/include/alloca.h error.h parser.h y.tab.h
lex.yy.o: /usr/include/unistd.h /usr/include/getopt.h
array.o: error.h parser.h y.tab.h
array.o: error.h gpl_assert.h parser.h y.tab.h
